

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Blacklisting &mdash; Graylog 1.2.0 documentation</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  

  

  
    <link rel="top" title="Graylog 1.2.0 documentation" href="../index.html"/>
        <link rel="next" title="Load balancer integration" href="load_balancers.html"/>
        <link rel="prev" title="Message rewriting with Drools" href="drools.html"/> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> Graylog
          

          
          </a>

          
            
            
              <div class="version">
                1.2
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="architecture.html">Architectural considerations</a></li>
<li class="toctree-l1"><a class="reference internal" href="getting_started.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installing Graylog</a></li>
<li class="toctree-l1"><a class="reference internal" href="configuring_es.html">Configuring and tuning Elasticsearch</a></li>
<li class="toctree-l1"><a class="reference internal" href="sending_data.html">Sending in log data</a></li>
<li class="toctree-l1"><a class="reference internal" href="collector.html">Graylog Collector</a></li>
<li class="toctree-l1"><a class="reference internal" href="queries.html">Searching</a></li>
<li class="toctree-l1"><a class="reference internal" href="streams.html">Streams</a></li>
<li class="toctree-l1"><a class="reference internal" href="dashboards.html">Dashboards</a></li>
<li class="toctree-l1"><a class="reference internal" href="extractors.html">Extractors</a></li>
<li class="toctree-l1"><a class="reference internal" href="drools.html">Message rewriting with Drools</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="">Blacklisting</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#how-to">How to</a></li>
<li class="toctree-l2"><a class="reference internal" href="#based-on-regular-expressions">Based on regular expressions</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="load_balancers.html">Load balancer integration</a></li>
<li class="toctree-l1"><a class="reference internal" href="index_model.html">The Graylog index model explained</a></li>
<li class="toctree-l1"><a class="reference internal" href="indexer_failures.html">Indexer failures and dead letters</a></li>
<li class="toctree-l1"><a class="reference internal" href="users_and_roles.html">Users and Roles</a></li>
<li class="toctree-l1"><a class="reference internal" href="plugins.html">Plugins</a></li>
<li class="toctree-l1"><a class="reference internal" href="external_dashboards.html">External dashboards</a></li>
<li class="toctree-l1"><a class="reference internal" href="marketplace.html">Graylog Marketplace</a></li>
<li class="toctree-l1"><a class="reference internal" href="faq.html">Frequently asked questions</a></li>
<li class="toctree-l1"><a class="reference internal" href="ideas_explained.html">The thinking behind the Graylog architecture and why it matters to you</a></li>
<li class="toctree-l1"><a class="reference internal" href="changelog.html">Changelog</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../index.html">Graylog</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          





<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../index.html">Docs</a> &raquo;</li>
      
    <li>Blacklisting</li>
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../_sources/pages/blacklisting.txt" rel="nofollow"> View page source</a>
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="blacklisting">
<span id="id1"></span><h1>Blacklisting<a class="headerlink" href="#blacklisting" title="Permalink to this headline">¶</a></h1>
<p>If you have messages coming into Graylog that should be discarded before being written to Elasticsearch
or forwarded to another system you can use <a class="reference internal" href="drools.html#drools"><span>Drools rules</span></a> to perform custom filtering.</p>
<p>The rule file location is defined in the Graylog configuration file:</p>
<div class="highlight-python"><div class="highlight"><pre># Drools Rule File (Use to rewrite incoming log messages)
rules_file = /etc/graylog.d/rules/graylog.drl
</pre></div>
</div>
<p>The rules file is located on the file system with a <code class="docutils literal"><span class="pre">.drl</span></code> file extension. The rules file can contain multiple rules, queries and functions,
as well as some resource declarations like imports, globals, and attributes that are assigned and used by your rules and queries.</p>
<p>For more information on the DRL rules syntax please read the <a class="reference external" href="http://docs.jboss.org/drools/release/5.5.0.Final/drools-expert-docs/html/ch04.html">Drools User Guide</a>.</p>
<div class="section" id="how-to">
<h2>How to<a class="headerlink" href="#how-to" title="Permalink to this headline">¶</a></h2>
<p>The general idea is simple: Any <code class="docutils literal"><span class="pre">Message</span></code> marked with <code class="docutils literal"><span class="pre">setFilterOut(true)</span></code> will be discarded when processed in the Graylog filter chain.
You can either <a class="reference internal" href="plugins.html#plugins"><span>write and load your own filter plugin</span></a> that can execute any Java code to mark messages or just use
the <a class="reference internal" href="drools.html#drools"><span>Drools rules</span></a>. The following example shows how to do this.</p>
</div>
<div class="section" id="based-on-regular-expressions">
<h2>Based on regular expressions<a class="headerlink" href="#based-on-regular-expressions" title="Permalink to this headline">¶</a></h2>
<p>Put this into your <code class="docutils literal"><span class="pre">rules_file</span></code>:</p>
<div class="highlight-python"><div class="highlight"><pre>import org.graylog2.plugin.Message
import java.util.regex.Matcher
import java.util.regex.Pattern

rule &quot;Blacklist all messages that start with &#39;firewall&#39;&quot;
  when
      m : Message( message matches &quot;^firewall.*&quot; )
  then
      System.out.println(&quot;DEBUG: Blacklisting message.&quot;); // Don&#39;t do this in production.
      m.setFilterOut(true);
end
</pre></div>
</div>
<p>This rule will blacklist any message that starts with the string &#8220;firewall&#8221; (<code class="docutils literal"><span class="pre">matches</span> <span class="pre">&quot;^firewall.*&quot;</span></code>).</p>
</div>
</div>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="load_balancers.html" class="btn btn-neutral float-right" title="Load balancer integration" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="drools.html" class="btn btn-neutral" title="Message rewriting with Drools" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2015 Graylog, Inc..

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'1.2.0',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>