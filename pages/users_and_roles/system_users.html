

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>System users &mdash; Graylog 1.2.0 documentation</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  

  

  
    <link rel="top" title="Graylog 1.2.0 documentation" href="../../index.html"/>
        <link rel="up" title="Users and Roles" href="../users_and_roles.html"/>
        <link rel="next" title="External authentication" href="external_auth.html"/>
        <link rel="prev" title="Roles" href="roles.html"/> 

  
  <script src="../../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../../index.html" class="icon icon-home"> Graylog
          

          
          </a>

          
            
            
              <div class="version">
                1.2
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../architecture.html">Architectural considerations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../getting_started.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installing Graylog</a></li>
<li class="toctree-l1"><a class="reference internal" href="../configuring_es.html">Configuring and tuning Elasticsearch</a></li>
<li class="toctree-l1"><a class="reference internal" href="../sending_data.html">Sending in log data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../collector.html">Graylog Collector</a></li>
<li class="toctree-l1"><a class="reference internal" href="../queries.html">Searching</a></li>
<li class="toctree-l1"><a class="reference internal" href="../streams.html">Streams</a></li>
<li class="toctree-l1"><a class="reference internal" href="../dashboards.html">Dashboards</a></li>
<li class="toctree-l1"><a class="reference internal" href="../extractors.html">Extractors</a></li>
<li class="toctree-l1"><a class="reference internal" href="../drools.html">Message rewriting with Drools</a></li>
<li class="toctree-l1"><a class="reference internal" href="../blacklisting.html">Blacklisting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../load_balancers.html">Load balancer integration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../index_model.html">The Graylog index model explained</a></li>
<li class="toctree-l1"><a class="reference internal" href="../indexer_failures.html">Indexer failures and dead letters</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../users_and_roles.html">Users and Roles</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="users.html">Users</a></li>
<li class="toctree-l2"><a class="reference internal" href="roles.html">Roles</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="">System users</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#rest-call-permissions">REST call permissions</a></li>
<li class="toctree-l3"><a class="reference internal" href="#creating-the-role">Creating the role</a></li>
<li class="toctree-l3"><a class="reference internal" href="#assigning-the-role-to-a-user">Assigning the role to a user</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="external_auth.html">External authentication</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../plugins.html">Plugins</a></li>
<li class="toctree-l1"><a class="reference internal" href="../external_dashboards.html">External dashboards</a></li>
<li class="toctree-l1"><a class="reference internal" href="../marketplace.html">Graylog Marketplace</a></li>
<li class="toctree-l1"><a class="reference internal" href="../faq.html">Frequently asked questions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ideas_explained.html">The thinking behind the Graylog architecture and why it matters to you</a></li>
<li class="toctree-l1"><a class="reference internal" href="../changelog.html">Changelog</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../../index.html">Graylog</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          





<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../../index.html">Docs</a> &raquo;</li>
      
          <li><a href="../users_and_roles.html">Users and Roles</a> &raquo;</li>
      
    <li>System users</li>
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../../_sources/pages/users_and_roles/system_users.txt" rel="nofollow"> View page source</a>
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="system-users">
<h1>System users<a class="headerlink" href="#system-users" title="Permalink to this headline">¶</a></h1>
<p>The Graylog permission system is extremely flexible and allows you to create users that are only allowed to perform
certain REST calls. The <a class="reference internal" href="roles.html#roles"><span>Roles</span></a>  UI allows you to create roles based on stream or dashboard access but does not
expose permissions on a REST call level yet. This guide describes how to create those roles using the Graylog REST API.</p>
<p>Let&#8217;s imagine we want to create a role that is only allowed to start or stop message processing on <code class="docutils literal"><span class="pre">graylog-server</span></code> nodes.</p>
<div class="section" id="rest-call-permissions">
<h2>REST call permissions<a class="headerlink" href="#rest-call-permissions" title="Permalink to this headline">¶</a></h2>
<p>Almost every REST call in Graylog has to be authenticated or it will return a HTTP 403 (Forbidden). In addition to that
the requesting user also has to have the permissions to execute the REST call. A Graylog admin user can always execute
all calls and roles based on the standard stream or dashboard permissions can execute calls related to those entities.</p>
<p>If you want to create a user that can only execute calls to start or stop message processing you have to find the name
of the required permission first. Until we include this functionality in the Graylog UI you&#8217;ll have to look directly
into the code. The permissions are listed in the <code class="docutils literal"><span class="pre">RestPermissions</span></code> class which you can find on
<a class="reference external" href="https://github.com/Graylog2/graylog2-server/blob/master/graylog2-shared/src/main/java/org/graylog2/shared/security/RestPermissions.java">GitHub</a>.
(Make sure to select a branch that reflects your current <code class="docutils literal"><span class="pre">graylog-server</span></code> version.)</p>
<p>The permission you are searching for in this case is:</p>
<div class="highlight-python"><div class="highlight"><pre>public static final String PROCESSING_CHANGESTATE = &quot;processing:changestate&quot;;
</pre></div>
</div>
</div>
<div class="section" id="creating-the-role">
<h2>Creating the role<a class="headerlink" href="#creating-the-role" title="Permalink to this headline">¶</a></h2>
<p>You can create a new role using the REST API like this:</p>
<div class="highlight-python"><div class="highlight"><pre>curl -v -XPOST -H &#39;Content-Type: application/json&#39; &#39;http://ADMIN:PASSWORD@graylog.example.org:12900/roles&#39; -d &#39;{&quot;read_only&quot;: false,&quot;permissions&quot;: [&quot;processing:changestate&quot;],&quot;name&quot;: &quot;Change processing state&quot;,&quot;description&quot;: &quot;Permission to start or stop processing on graylog-server nodes&quot;}&#39;
</pre></div>
</div>
<p>Notice the <code class="docutils literal"><span class="pre">processing:changestate</span></code> permission that we assigned. Every user with this role will be able to
execute only calls that start or stop processing on <code class="docutils literal"><span class="pre">graylog-server</span></code> nodes. (and also the standard <code class="docutils literal"><span class="pre">reader</span></code> permissions
that do not provide any access to data or maintenance functionalities though.)</p>
<p>This is the POST body in an easier to read formatting:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="p">{</span>
  <span class="s">&quot;name&quot;</span><span class="p">:</span> <span class="s">&quot;Change processing state&quot;</span><span class="p">,</span>
  <span class="s">&quot;description&quot;</span><span class="p">:</span> <span class="s">&quot;Permission to start or stop processing on graylog-server nodes&quot;</span><span class="p">,</span>
  <span class="s">&quot;permissions&quot;</span><span class="p">:</span> <span class="p">[</span>
    <span class="s">&quot;processing:changestate&quot;</span>
  <span class="p">],</span>
  <span class="s">&quot;read_only&quot;</span><span class="p">:</span> <span class="n">false</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="assigning-the-role-to-a-user">
<h2>Assigning the role to a user<a class="headerlink" href="#assigning-the-role-to-a-user" title="Permalink to this headline">¶</a></h2>
<p>Create a new user in the Graylog Web Interface and assign the new role to it:</p>
<img alt="../../_images/sysuser.png" src="../../_images/sysuser.png" />
<p>Every user needs to at least have the standard <code class="docutils literal"><span class="pre">reader</span></code> permissions but those do not provide any access to data
or maintenance functionalities.</p>
<p>Now request the user information to see what permissions have been assigned:</p>
<div class="highlight-python"><div class="highlight"><pre>$ curl -XGET &#39;http://ADMIN:PASSWORT@graylog.example.org:12900/users/maintenanceuser?pretty=true&#39;
{
  &quot;id&quot; : &quot;563d1024d4c63709999c4ac2&quot;,
  &quot;username&quot; : &quot;maintenanceuser&quot;,
  &quot;email&quot; : &quot;it-ops@example.org&quot;,
  &quot;full_name&quot; : &quot;Rock Solid&quot;,
  &quot;permissions&quot; : [
    &quot;indexercluster:read&quot;,
    &quot;messagecount:read&quot;,
    &quot;journal:read&quot;,
    &quot;inputs:read&quot;,
    &quot;metrics:read&quot;,
    &quot;processing:changestate&quot;,
    &quot;savedsearches:edit&quot;,
    &quot;fieldnames:read&quot;,
    &quot;buffers:read&quot;,
    &quot;system:read&quot;,
    &quot;users:edit:maintenanceuser&quot;,
    &quot;users:passwordchange:maintenanceuser&quot;,
    &quot;savedsearches:create&quot;,
    &quot;jvmstats:read&quot;,
    &quot;throughput:read&quot;,
    &quot;savedsearches:read&quot;,
    &quot;messages:read&quot;
  ],
  &quot;preferences&quot; : {
    &quot;updateUnfocussed&quot; : false,
    &quot;disableExpensiveUpdates&quot; : false,
    &quot;enableSmartSearch&quot; : true
  },
  &quot;timezone&quot; : &quot;America/Chicago&quot;,
  &quot;session_timeout_ms&quot; : 300000,
  &quot;read_only&quot; : false,
  &quot;external&quot; : false,
  &quot;startpage&quot; : { },
  &quot;roles&quot; : [
    &quot;Change processing state&quot;,
    &quot;Reader&quot;
  ]
}
</pre></div>
</div>
<p>Now you can use this user in your maintenance scripts or automated tasks.</p>
</div>
</div>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="external_auth.html" class="btn btn-neutral float-right" title="External authentication" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="roles.html" class="btn btn-neutral" title="Roles" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2015 Graylog, Inc..

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../../',
            VERSION:'1.2.0',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../../_static/jquery.js"></script>
      <script type="text/javascript" src="../../_static/underscore.js"></script>
      <script type="text/javascript" src="../../_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="../../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>