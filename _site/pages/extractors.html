

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Extractors &mdash; Graylog 1.2.0 documentation</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  

  

  
    <link rel="top" title="Graylog 1.2.0 documentation" href="../index.html"/>
        <link rel="next" title="Message rewriting with Drools" href="drools.html"/>
        <link rel="prev" title="Dashboards" href="dashboards.html"/> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> Graylog
          

          
          </a>

          
            
            
              <div class="version">
                1.2
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="architecture.html">Architectural considerations</a></li>
<li class="toctree-l1"><a class="reference internal" href="getting_started.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installing Graylog</a></li>
<li class="toctree-l1"><a class="reference internal" href="configuring_es.html">Configuring and tuning Elasticsearch</a></li>
<li class="toctree-l1"><a class="reference internal" href="sending_data.html">Sending in log data</a></li>
<li class="toctree-l1"><a class="reference internal" href="collector.html">Graylog Collector</a></li>
<li class="toctree-l1"><a class="reference internal" href="queries.html">Searching</a></li>
<li class="toctree-l1"><a class="reference internal" href="streams.html">Streams</a></li>
<li class="toctree-l1"><a class="reference internal" href="dashboards.html">Dashboards</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="">Extractors</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#the-problem-explained">The problem explained</a></li>
<li class="toctree-l2"><a class="reference internal" href="#graylog-extractors-explained">Graylog extractors explained</a></li>
<li class="toctree-l2"><a class="reference internal" href="#import-extractors">Import extractors</a></li>
<li class="toctree-l2"><a class="reference internal" href="#using-regular-expressions-to-extract-data">Using regular expressions to extract data</a></li>
<li class="toctree-l2"><a class="reference internal" href="#using-grok-patterns-to-extract-data">Using Grok patterns to extract data</a></li>
<li class="toctree-l2"><a class="reference internal" href="#using-the-json-extractor">Using the JSON extractor</a></li>
<li class="toctree-l2"><a class="reference internal" href="#automatically-extract-all-key-value-pairs">Automatically extract all key=value pairs</a></li>
<li class="toctree-l2"><a class="reference internal" href="#normalization">Normalization</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#the-standard-date-converter">The standard date converter</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#standard-date-converter-format-string-table">Standard date converter format string table</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#the-flexible-date-converter">The flexible date converter</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="drools.html">Message rewriting with Drools</a></li>
<li class="toctree-l1"><a class="reference internal" href="blacklisting.html">Blacklisting</a></li>
<li class="toctree-l1"><a class="reference internal" href="load_balancers.html">Load balancer integration</a></li>
<li class="toctree-l1"><a class="reference internal" href="index_model.html">The Graylog index model explained</a></li>
<li class="toctree-l1"><a class="reference internal" href="indexer_failures.html">Indexer failures and dead letters</a></li>
<li class="toctree-l1"><a class="reference internal" href="users_and_roles.html">Users and Roles</a></li>
<li class="toctree-l1"><a class="reference internal" href="plugins.html">Plugins</a></li>
<li class="toctree-l1"><a class="reference internal" href="external_dashboards.html">External dashboards</a></li>
<li class="toctree-l1"><a class="reference internal" href="marketplace.html">Graylog Marketplace</a></li>
<li class="toctree-l1"><a class="reference internal" href="faq.html">Frequently asked questions</a></li>
<li class="toctree-l1"><a class="reference internal" href="ideas_explained.html">The thinking behind the Graylog architecture and why it matters to you</a></li>
<li class="toctree-l1"><a class="reference internal" href="changelog.html">Changelog</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../index.html">Graylog</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          





<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../index.html">Docs</a> &raquo;</li>
      
    <li>Extractors</li>
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../_sources/pages/extractors.txt" rel="nofollow"> View page source</a>
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="extractors">
<h1>Extractors<a class="headerlink" href="#extractors" title="Permalink to this headline">¶</a></h1>
<div class="section" id="the-problem-explained">
<h2>The problem explained<a class="headerlink" href="#the-problem-explained" title="Permalink to this headline">¶</a></h2>
<p>Syslog (<a class="reference external" href="http://tools.ietf.org/html/rfc3146">RFC3146</a>, <a class="reference external" href="http://tools.ietf.org/html/rfc5424">RFC5424</a>) is the de facto
standard logging protocol since the 1980s and was originally developed as part of the sendmail project. It comes with some
annoying shortcomings that we tried to improve in <a class="reference external" href="http://www.graylog.org/gelf">GELF</a> for application logging.</p>
<p>Because syslog has a clear specification in its RFCs it should be possible to parse it relatively easy. Unfortunately
there are a lot of devices (especially routers and firewalls) out there that send logs looking like syslog but actually
breaking several rules stated in the RFCs. We tried to write a parser that reads all of them as good as possible and
failed. Such a loosely defined text message usually breaks the compatibility in the first date field already. Some
devices leave out hostnames completely, some use localized time zone names (e. g. &#8220;MESZ&#8221; instead of &#8220;CEST&#8221;),
and some just omit the current year in the timestamp field.</p>
<p>Then there are devices out there that at least do not claim to send syslog when they don&#8217;t but have another completely
separate log format that needs to be parsed specifically.</p>
<p>We decided not to write custom message inputs and parsers for all those thousands of devices, formats, firmwares and
configuration parameters out there but came up with the concept of <em>Extractors</em> introduced the <em>v0.20.0</em> series of Graylog.</p>
</div>
<div class="section" id="graylog-extractors-explained">
<h2>Graylog extractors explained<a class="headerlink" href="#graylog-extractors-explained" title="Permalink to this headline">¶</a></h2>
<p>The extractors allow you to instruct Graylog nodes about how to extract data from any text in the received
message (no matter from which format or if an already extracted field) to message fields. You may already know why
structuring data into fields is important if you are using Graylog: There are a lot of analysis possibilities with
full text searches but the real power of log analytics unveils when you can run queries like
<code class="docutils literal"><span class="pre">http_response_code:&gt;=500</span> <span class="pre">AND</span> <span class="pre">user_id:9001</span></code> to get all internal server errors that were triggered by a specific user.</p>
<p>Wouldn&#8217;t it be nice to be able to search for all blocked packages of a given source IP or to get a quickterms analysis
of recently failed SSH login usernames? Hard to do when all you have is just a single long text message.</p>
<p>Creating extractors is possible via either Graylog REST API calls or from the web interface using a wizard. Select
a message input on the <em>System</em> -&gt; <em>Inputs</em> page and hit <em>Manage extractors</em> in the actions menu. The wizard allows
you to load a message to test your extractor configuration against. You can extract data using for example regular
expressions, Grok patterns, substrings, or even by splitting the message into tokens by separator characters.
The wizard looks like this and should be pretty intuitive:</p>
<img alt="../_images/extractors_1.png" src="../_images/extractors_1.png" />
<p>You can also choose to apply so called <em>converters</em> on the extracted value to for example convert a string consisting
of numbers to an integer or double value (important for range searches later), anonymize IP addresses, lower-/uppercase a
string, build a hash value, and much more.</p>
</div>
<div class="section" id="import-extractors">
<h2>Import extractors<a class="headerlink" href="#import-extractors" title="Permalink to this headline">¶</a></h2>
<p>The recommended way of importing extractors in Graylog is using <a class="reference internal" href="sending_data.html#content-packs"><span>Content packs</span></a>. The
<a class="reference external" href="http://marketplace.graylog.org">Graylog Marketplace</a> provides access to many content packs that you can easily
download and import into your Graylog setup.</p>
<p>You can still import extractors from JSON if you want to. Just copy the JSON extractor export into the import dialog
of a message input of the fitting type (every extractor set entry in the directory tells you what type of input to
spawn, e. g. syslog, GELF, or Raw/plaintext) and you are good to go. The next messages coming in should already
include the extracted fields with possibly converted values.</p>
<p>A message sent by Heroku and received by Graylog with the imported <em>Heroku</em> extractor set on a plaintext TCP input
looks like this: (look at the extracted fields in the message detail view)</p>
<img alt="../_images/extractors_2.png" src="../_images/extractors_2.png" />
</div>
<div class="section" id="using-regular-expressions-to-extract-data">
<h2>Using regular expressions to extract data<a class="headerlink" href="#using-regular-expressions-to-extract-data" title="Permalink to this headline">¶</a></h2>
<p>Extractors support matching field values using regular expressions.
Graylog uses the <a class="reference external" href="http://docs.oracle.com/javase/7/docs/api/java/util/regex/Pattern.html">Java Pattern class</a> to
evaluate regular expressions.</p>
<p>For the individual elements of regular expression syntax, please refer to Oracle&#8217;s documentation, however the syntax
largely follows the familiar regular expression languages in widespread use today and will be familiar to most.</p>
<p>However, one key question that is often raised is matching a string in case insensitive manner. Java regular expressions
are case sensitive by default. Certain flags, such as the one to ignore case sensitivity can either be set in the code,
or as an inline flag in the regular expression.</p>
<p>For example, to create an extractor that matches the browser name in the following user agent string:</p>
<div class="highlight-python"><div class="highlight"><pre>Mozilla/5.0 (Macintosh; Intel Mac OS X 10_9_1) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/32.0.1700.107 Safari/537.36
</pre></div>
</div>
<p>the regular expression <code class="docutils literal"><span class="pre">(applewebkit)</span></code> will not match because it is case sensitive.
In order to match the expression using any combination of upper- and lowercase characters use the <code class="docutils literal"><span class="pre">(?i)</span></code> flag as such:</p>
<div class="highlight-python"><div class="highlight"><pre>(?i)(applewebkit)
</pre></div>
</div>
<p>Most of the other flags supported by Java are rarely used in the context of matching stream rules or extractors, but if
you need them their use is documented on the same Javadoc page by Oracle. One common reason to use regular expression flags
in your regular expression is to make use of what is called non-capturing groups. Those are parentheses which only group
alternatives, but do not make Graylog extract the data they match and are indicated by <code class="docutils literal"><span class="pre">(?:)</span></code>.</p>
</div>
<div class="section" id="using-grok-patterns-to-extract-data">
<h2>Using Grok patterns to extract data<a class="headerlink" href="#using-grok-patterns-to-extract-data" title="Permalink to this headline">¶</a></h2>
<p>Graylog also supports the extracting data using the popular Grok language to allow you to make use of your existing patterns.</p>
<p>Grok is a set of regular expressions that can be combined to more complex patterns, allowing to name different parts of the
matched groups.</p>
<p>By using Grok patterns, you can extract multiple fields from a message field in a single extractor, which often simplifies
specifying extractors.</p>
<p>Simple regular expressions are often sufficient to extract a single word or number from a log line, but if you know the entire
structure of a line beforehand, for example for an access log, or the format of a firewall log, using Grok is advantageous.</p>
<p>For example a firewall log line could contain:</p>
<div class="highlight-python"><div class="highlight"><pre>len=50824 src=172.17.22.108 sport=829 dst=192.168.70.66 dport=513
</pre></div>
</div>
<p>We can now create the following patterns on the <code class="docutils literal"><span class="pre">System/Grok</span> <span class="pre">Patterns</span></code> page in the web interface:</p>
<div class="highlight-python"><div class="highlight"><pre>BASE10NUM (?&lt;![0-9.+-])(?&gt;[+-]?(?:(?:[0-9]+(?:\.[0-9]+)?)|(?:\.[0-9]+)))
NUMBER (?:%{BASE10NUM})
IPV6 ((([0-9A-Fa-f]{1,4}:){7}([0-9A-Fa-f]{1,4}|:))|(([0-9A-Fa-f]{1,4}:){6}(:[0-9A-Fa-f]{1,4}|((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9A-Fa-f]{1,4}:){5}(((:[0-9A-Fa-f]{1,4}){1,2})|:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9A-Fa-f]{1,4}:){4}(((:[0-9A-Fa-f]{1,4}){1,3})|((:[0-9A-Fa-f]{1,4})?:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){3}(((:[0-9A-Fa-f]{1,4}){1,4})|((:[0-9A-Fa-f]{1,4}){0,2}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){2}(((:[0-9A-Fa-f]{1,4}){1,5})|((:[0-9A-Fa-f]{1,4}){0,3}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){1}(((:[0-9A-Fa-f]{1,4}){1,6})|((:[0-9A-Fa-f]{1,4}){0,4}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(:(((:[0-9A-Fa-f]{1,4}){1,7})|((:[0-9A-Fa-f]{1,4}){0,5}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:)))(%.+)?
IPV4 (?&lt;![0-9])(?:(?:25[0-5]|2[0-4][0-9]|[0-1]?[0-9]{1,2})[.](?:25[0-5]|2[0-4][0-9]|[0-1]?[0-9]{1,2})[.](?:25[0-5]|2[0-4][0-9]|[0-1]?[0-9]{1,2})[.](?:25[0-5]|2[0-4][0-9]|[0-1]?[0-9]{1,2}))(?![0-9])
IP (?:%{IPV6}|%{IPV4})
DATA .*?
</pre></div>
</div>
<p>Then, in the extractor configuration, we can use these patterns to extract the relevant fields from the line:</p>
<div class="highlight-python"><div class="highlight"><pre>len=%{NUMBER:length} src=%{IP:srcip} sport=%{NUMBER:srcport} dst=%{IP:dstip} dport=%{NUMBER:dstport}
</pre></div>
</div>
<p>This will add the relevant extracted fields to our log message, allowing Graylog to search on those individual fields, which
can lead to more effective search queries by allowing to specifically look for packets that came from a specific source IP
instead of also matching destination IPs if one would only search for the IP across all fields.</p>
<p>If the Grok pattern creates many fields, which can happen if you make use of heavily nested patterns, you can tell Graylog to skip
certain fields (and the output of their subpatterns) by naming a field with the special keyword <code class="docutils literal"><span class="pre">UNWANTED</span></code>.</p>
<p>Let&#8217;s say you want to parse a line like:</p>
<div class="highlight-python"><div class="highlight"><pre>type:44 bytes:34 errors:122
</pre></div>
</div>
<p>but you are only interested in the second number <code class="docutils literal"><span class="pre">bytes</span></code>. You could use a pattern like:</p>
<div class="highlight-python"><div class="highlight"><pre>type:%{BASE10NUM:type} bytes:%{BASE10NUM:bytes} errors:%{BASE10NUM:errors}
</pre></div>
</div>
<p>However, this would create three fields named <code class="docutils literal"><span class="pre">type</span></code>, <code class="docutils literal"><span class="pre">bytes</span></code>, and <code class="docutils literal"><span class="pre">errors</span></code>. Even not naming the first and last patterns would
still create a field names <code class="docutils literal"><span class="pre">BASE10NUM</span></code>. In order to ignore fields, but still require matching them use <code class="docutils literal"><span class="pre">UNWANTED</span></code>:</p>
<div class="highlight-python"><div class="highlight"><pre>type:%{BASE10NUM:UNWANTED} bytes:%{BASE10NUM:bytes} errors:%{BASE10NUM:UNWANTED}
</pre></div>
</div>
<p>This now creates only a single field called <code class="docutils literal"><span class="pre">bytes</span></code> while making sure the entire pattern must match.</p>
<p>If you already know the data type of the extracted fields, you can make use of the type conversion feature built into the Graylog
Grok library. Going back to the earlier example:</p>
<div class="highlight-python"><div class="highlight"><pre>len=50824 src=172.17.22.108 sport=829 dst=192.168.70.66 dport=513
</pre></div>
</div>
<p>We know that the content of the field <code class="docutils literal"><span class="pre">len</span></code> is an integer and would like to make sure it is stored with that data type, so we can
later create field graphs with it or access the field&#8217;s statistical values, like average etc.</p>
<p>Grok directly supports converting field values by adding <code class="docutils literal"><span class="pre">;datatype</span></code> at the end of the pattern, like:</p>
<div class="highlight-python"><div class="highlight"><pre>len=%{NUMBER:length;int} src=%{IP:srcip} sport=%{NUMBER:srcport} dst=%{IP:dstip} dport=%{NUMBER:dstport}
</pre></div>
</div>
<p>The currently supported data types, and their corresponding ranges and values, are:</p>
<table border="1" class="docutils">
<colgroup>
<col width="5%" />
<col width="62%" />
<col width="33%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Type</th>
<th class="head">Range</th>
<th class="head">Example</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>byte</td>
<td>-128 ... 127</td>
<td><code class="docutils literal"><span class="pre">%{NUMBER:fieldname;byte}</span></code></td>
</tr>
<tr class="row-odd"><td>short</td>
<td>-32768 ... 32767</td>
<td><code class="docutils literal"><span class="pre">%{NUMBER:fieldname;short}</span></code></td>
</tr>
<tr class="row-even"><td>int</td>
<td>-2^31 ... 2^31 -1</td>
<td><code class="docutils literal"><span class="pre">%{NUMBER:fieldname;int}</span></code></td>
</tr>
<tr class="row-odd"><td>long</td>
<td>-2^63 ... 2^63 -1</td>
<td><code class="docutils literal"><span class="pre">%{NUMBER:fieldname;long}</span></code></td>
</tr>
<tr class="row-even"><td>float</td>
<td>32-bit IEEE 754</td>
<td><code class="docutils literal"><span class="pre">%{NUMBER:fieldname;float}</span></code></td>
</tr>
<tr class="row-odd"><td>double</td>
<td>64-bit IEEE 754</td>
<td><code class="docutils literal"><span class="pre">%{NUMBER:fieldname;double}</span></code></td>
</tr>
<tr class="row-even"><td>boolean</td>
<td><cite>true</cite>, <cite>false</cite></td>
<td><code class="docutils literal"><span class="pre">%{DATA:fieldname;boolean}</span></code></td>
</tr>
<tr class="row-odd"><td>string</td>
<td>Any UTF-8 string</td>
<td><code class="docutils literal"><span class="pre">%{DATA:fieldname;string}</span></code></td>
</tr>
<tr class="row-even"><td>date</td>
<td>See <a class="reference external" href="http://docs.oracle.com/javase/7/docs/api/java/text/SimpleDateFormat.html">SimpleDateFormat</a></td>
<td><code class="docutils literal"><span class="pre">%{DATA:timestamp;date;dd/MMM/yyyy:HH:mm:ss</span> <span class="pre">Z}</span></code></td>
</tr>
<tr class="row-odd"><td>datetime</td>
<td>Alias for <cite>date</cite></td>
<td>&nbsp;</td>
</tr>
</tbody>
</table>
<p>There are many resources are the web with useful patterns, and one very helpful tool is the <a class="reference external" href="http://grokdebug.herokuapp.com/">Grok Debugger</a>,
which allows you to test your patterns while you develop them.</p>
<p>Graylog uses <a class="reference external" href="http://grok.nflabs.com/">Java Grok</a> to parse and run Grok patterns.</p>
</div>
<div class="section" id="using-the-json-extractor">
<h2>Using the JSON extractor<a class="headerlink" href="#using-the-json-extractor" title="Permalink to this headline">¶</a></h2>
<p>Since version 1.2, Graylog also supports extracting data from messages sent in JSON format.</p>
<p>Using the JSON extractor is easy: once a Graylog input receives messages in JSON format, you can create an extractor
by going to <em>System</em> -&gt; <em>Inputs</em> and clicking on the <em>Manage extractors</em> button for that input. Next, you need to load a
message to extract data from, and select the field containing the JSON document. The following page let you add some extra
information to tell Graylog how it should extract the information. Let&#8217;s illustrate how a message would be extracted
with an example message:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="p">{</span><span class="s">&quot;level&quot;</span><span class="p">:</span> <span class="s">&quot;ERROR&quot;</span><span class="p">,</span> <span class="s">&quot;details&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s">&quot;message&quot;</span><span class="p">:</span> <span class="s">&quot;This is an example error message&quot;</span><span class="p">,</span> <span class="s">&quot;controller&quot;</span><span class="p">:</span> <span class="s">&quot;IndexController&quot;</span><span class="p">,</span> <span class="s">&quot;tags&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s">&quot;one&quot;</span><span class="p">,</span> <span class="s">&quot;two&quot;</span><span class="p">,</span> <span class="s">&quot;three&quot;</span><span class="p">]}}</span>
</pre></div>
</div>
<p>Using the default settings, that message would be extracted into these fields:</p>
<dl class="docutils">
<dt>details.tags</dt>
<dd>one, two, three</dd>
<dt>level</dt>
<dd>ERROR</dd>
<dt>details.controller</dt>
<dd>IndexController</dd>
<dt>details.message</dt>
<dd>This is an example error message</dd>
</dl>
<p>In the create extractor page, you can also customize how to separate list of elements, keys, and key/values. It is also possible
to flatten JSON structures or expand them into multiple fields, as shown in the example above.</p>
</div>
<div class="section" id="automatically-extract-all-key-value-pairs">
<h2>Automatically extract all key=value pairs<a class="headerlink" href="#automatically-extract-all-key-value-pairs" title="Permalink to this headline">¶</a></h2>
<p>Sometimes you will receive messages like this:</p>
<div class="highlight-python"><div class="highlight"><pre>This is a test message with some key/value pairs. key1=value1 some_other_key=foo
</pre></div>
</div>
<p>You might want to extract all <code class="docutils literal"><span class="pre">key=value</span></code> pairs into Graylog message fields without having to specify all possible key names or
even their order. This is how you can easily do this:</p>
<p>Create a new extractor of type &#8220;Copy Input&#8221; and select to read from the field <code class="docutils literal"><span class="pre">message</span></code>. (Or any other string field that contains
<code class="docutils literal"><span class="pre">key=value</span></code> pairs.) Configure the extractor to store the (copied) field value to the same field. In this case <code class="docutils literal"><span class="pre">message</span></code>. The
trick is to add the &#8220;Key=Value pairs to fields&#8221; converter as last step. Because we use the &#8220;Copy Input&#8221; extractor, the converter
will run over the complete field you selected and convert all <code class="docutils literal"><span class="pre">key=value</span></code> pairs it can find.</p>
<p>This is a screenshot of the complete extractor configuration:</p>
<img alt="../_images/keyvalue_converter_1.png" src="../_images/keyvalue_converter_1.png" />
<p>... and this is the resulting message:</p>
<img alt="../_images/keyvalue_converter_2.png" src="../_images/keyvalue_converter_2.png" />
</div>
<div class="section" id="normalization">
<h2>Normalization<a class="headerlink" href="#normalization" title="Permalink to this headline">¶</a></h2>
<p>Many log formats are similar to each other, but not quite the same. In particular they often only differ in the names attached
to pieces of information.</p>
<p>For example, consider different hardware firewall vendors, whose models log the destination IP in different fields of the message,
some use <code class="docutils literal"><span class="pre">dstip</span></code>, some <code class="docutils literal"><span class="pre">dst</span></code> and yet others use <code class="docutils literal"><span class="pre">destination-address</span></code>:</p>
<div class="highlight-python"><div class="highlight"><pre>2004-10-13 10:37:17 PDT Packet Length=50824, Source address=172.17.22.108, Source port=829, Destination address=192.168.70.66, Destination port=513
2004-10-13 10:37:17 PDT len=50824 src=172.17.22.108 sport=829 dst=192.168.70.66 dport=513
2004-10-13 10:37:17 PDT length=&quot;50824&quot; srcip=&quot;172.17.22.108&quot; srcport=&quot;829&quot; dstip=&quot;192.168.70.66&quot; dstport=&quot;513&quot;
</pre></div>
</div>
<p>You can use one or more non-capturing groups to specify the alternatives of the field names, but still be able to extract the a
parentheses group in the regular expression. Remember that Graylog will extract data from the first matched group of the regular
expression. An example of a regular expression matching the destination IP field of all those log messages from above is:</p>
<div class="highlight-python"><div class="highlight"><pre>(?:dst|dstip|[dD]estination\saddress)=&quot;?(\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3})&quot;?
</pre></div>
</div>
<p>This will only extract the IP address without caring about which of the three naming schemes was used in the original log message.
This way you don&#8217;t have to set up three different extractors.</p>
<div class="section" id="the-standard-date-converter">
<h3>The standard date converter<a class="headerlink" href="#the-standard-date-converter" title="Permalink to this headline">¶</a></h3>
<p>Date parser converters for extractors allow you to convert extracted data into timestamps - Usually used to set the timestamp of
a message based on some date it contains. Let&#8217;s assume we have this message from a network device:</p>
<div class="highlight-python"><div class="highlight"><pre>&lt;131&gt;: foo-bar-dc3-org-de01: Mar 12 00:45:38: %LINK-3-UPDOWN: Interface GigabitEthernet0/31, changed state to down
</pre></div>
</div>
<p>Extracting most of the data is not a problem and can be done easily. Using the date in the message (<cite>Mar 12 00:45:38</cite>) as Graylog
message timestamp however needs to be done with a date parser converter.</p>
<p>Use a standard extractor rule to select the timestamp and apply the <em>Date</em> converter with a format string:</p>
<div class="highlight-python"><div class="highlight"><pre>MMM dd HH:mm:ss
</pre></div>
</div>
<p>(format string table at the end of this page)</p>
<img alt="../_images/dateparser_1.png" src="../_images/dateparser_1.png" />
<img alt="../_images/dateparser_2.png" src="../_images/dateparser_2.png" />
<div class="section" id="standard-date-converter-format-string-table">
<h4>Standard date converter format string table<a class="headerlink" href="#standard-date-converter-format-string-table" title="Permalink to this headline">¶</a></h4>
<table border="1" class="docutils">
<colgroup>
<col width="7%" />
<col width="35%" />
<col width="15%" />
<col width="43%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Symbol</th>
<th class="head">Meaning</th>
<th class="head">Presentation</th>
<th class="head">Examples</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>G</td>
<td>era</td>
<td>text</td>
<td>AD</td>
</tr>
<tr class="row-odd"><td>C</td>
<td>century of era (&gt;=0)</td>
<td>number</td>
<td>20</td>
</tr>
<tr class="row-even"><td>Y</td>
<td>year of era (&gt;=0)</td>
<td>year</td>
<td>1996</td>
</tr>
<tr class="row-odd"><td>x</td>
<td>weekyear</td>
<td>year</td>
<td>1996</td>
</tr>
<tr class="row-even"><td>w</td>
<td>week of weekyear</td>
<td>number</td>
<td>27</td>
</tr>
<tr class="row-odd"><td>e</td>
<td>day of week</td>
<td>number</td>
<td>2</td>
</tr>
<tr class="row-even"><td>E</td>
<td>day of week</td>
<td>text</td>
<td>Tuesday; Tue</td>
</tr>
<tr class="row-odd"><td>y</td>
<td>year</td>
<td>year</td>
<td>1996</td>
</tr>
<tr class="row-even"><td>D</td>
<td>day of year</td>
<td>number</td>
<td>189</td>
</tr>
<tr class="row-odd"><td>M</td>
<td>month of year</td>
<td>month</td>
<td>July; Jul; 07</td>
</tr>
<tr class="row-even"><td>d</td>
<td>day of month</td>
<td>number</td>
<td>10</td>
</tr>
<tr class="row-odd"><td>a</td>
<td>halfday of day</td>
<td>text</td>
<td>PM</td>
</tr>
<tr class="row-even"><td>K</td>
<td>hour of halfday (0~11)</td>
<td>number</td>
<td>0</td>
</tr>
<tr class="row-odd"><td>h</td>
<td>clockhour of halfday (1~12)</td>
<td>number</td>
<td>12</td>
</tr>
<tr class="row-even"><td>H</td>
<td>hour of day (0~23)</td>
<td>number</td>
<td>0</td>
</tr>
<tr class="row-odd"><td>k</td>
<td>clockhour of day (1~24)</td>
<td>number</td>
<td>24</td>
</tr>
<tr class="row-even"><td>m</td>
<td>minute of hour</td>
<td>number</td>
<td>30</td>
</tr>
<tr class="row-odd"><td>s</td>
<td>second of minute</td>
<td>number</td>
<td>55</td>
</tr>
<tr class="row-even"><td>S</td>
<td>fraction of second</td>
<td>millis</td>
<td>978</td>
</tr>
<tr class="row-odd"><td>z</td>
<td>time zone</td>
<td>text</td>
<td>Pacific Standard Time; PST</td>
</tr>
<tr class="row-even"><td>Z</td>
<td>time zone offset/id</td>
<td>zone</td>
<td>-0800; -08:00; America/Los_Angeles</td>
</tr>
<tr class="row-odd"><td>&#8216;</td>
<td>escape for text</td>
<td>delimiter</td>
<td>&nbsp;</td>
</tr>
<tr class="row-even"><td>&#8216;&#8217;</td>
<td>single quote</td>
<td>literal</td>
<td>&#8216;</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section" id="the-flexible-date-converter">
<h3>The flexible date converter<a class="headerlink" href="#the-flexible-date-converter" title="Permalink to this headline">¶</a></h3>
<p>Now imagine you had one of those devices that send messages that are not so easy to parse because they do not follow a strict
timestamp format. Some network devices for example like to send days of the month without adding a padding 0 for the first 9 days.
You&#8217;ll have dates like <code class="docutils literal"><span class="pre">Mar</span> <span class="pre">9</span></code> and <code class="docutils literal"><span class="pre">Mar</span> <span class="pre">10</span></code> and end up having problems defining a parser string for that. Or maybe you have
something else that is really exotic like just <em>last wednesday</em> as timestamp. The flexible date converter is accepting any
text data and tries to build a date from that as good as it can.</p>
<p>Examples:</p>
<ul class="simple">
<li><strong>Mar 12</strong>, converted at 12:27:00 UTC in the year 2014: 2014-03-12T12:27:00.000</li>
<li><strong>2014-3-12 12:27</strong>: 2014-03-12T12:27:00.000</li>
<li><strong>Mar 12 2pm</strong>: 2014-03-12T14:00:00.000</li>
</ul>
<p>Note that the flexible date converter is using UTC as time zone by default unless you have time zone information in the parsed text
or have configured another time zone when adding the flexible date converter to an extractor (see this <a class="reference external" href="http://joda-time.sourceforge.net/timezones.html">comprehensive list of time zones</a>
available for the flexible date converter).</p>
</div>
</div>
</div>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="drools.html" class="btn btn-neutral float-right" title="Message rewriting with Drools" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="dashboards.html" class="btn btn-neutral" title="Dashboards" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2015 Graylog, Inc..

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'1.2.0',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>